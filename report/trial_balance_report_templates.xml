<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Report Template -->
    <template id="report_trial_balance">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <!-- Enhanced Header Section -->
                <div style="padding:15px; border-bottom:2px solid #000;">
                    <div style="text-align:center; margin-bottom:10px;">
                        <h2 style="margin:0; font-size:18px; font-weight:bold;">BALANCE DE COMPROBACIÓN</h2>
                        <h3 style="margin:5px 0; font-size:16px; font-weight:normal;">TRIAL BALANCE</h3>
                    </div>
                    <table style="width:100%; margin-bottom:10px;">
                        <tr>
                            <td style="width:50%; vertical-align:top;">
                                <strong>Razón Social:</strong> <t t-esc="company_name"/><br/>
                                <t t-if="company_vat">
                                    <strong>RUC/NIT:</strong> <t t-esc="company_vat"/><br/>
                                </t>
                                <t t-if="company_address">
                                    <strong>Dirección:</strong> <t t-esc="company_address"/><br/>
                                </t>
                            </td>
                            <td style="width:50%; vertical-align:top; text-align:right;">
                                <t t-if="start_date">
                                    <strong>Fecha Inicio:</strong> <t t-esc="start_date"/><br/>
                                </t>
                                <t t-if="end_date">
                                    <strong>Fecha Fin:</strong> <t t-esc="end_date"/><br/>
                                </t>
                                <t t-if="state">
                                    <strong>Estado:</strong> <t t-esc="state"/><br/>
                                </t>
                                <t t-if="journals_name">
                                    <strong>Diarios:</strong> <t t-esc="journals_name"/><br/>
                                </t>
                            </td>
                        </tr>
                    </table>
                </div>
                
                <!-- Balance Validation Message -->
                <t t-if="not is_balanced">
                    <div style="padding:10px; background-color:#fff3cd; border:1px solid #ffc107; margin:10px 0; border-radius:4px;">
                        <strong style="color:#856404;">⚠ ADVERTENCIA:</strong> 
                        <span style="color:#856404;">El balance no está equilibrado. Diferencia: <t t-esc="currency"/><t t-esc="balance_difference"/></span>
                    </div>
                </t>
                
                <div class="page" style="margin-top:15px;">
                    <center>
                        <t t-if="query">
                            <h3 style="margin:0;">BALANCE DE COMPROBACIÓN</h3>
                        </t>
                        <t t-else="">
                            <h3>No hay datos disponibles</h3>
                        </t>
                    </center>
                </div>
                <br/>
                <t t-if="query">
                    <table class="table table-sm" style="width:100%; border-collapse:collapse; font-size:11px;">
                        <thead>
                            <tr style="background-color:#f0f0f0; border-bottom:2px solid #000;">
                                <th style="padding:8px; text-align:left; border:1px solid #ddd; width:12%;">Número de Cuenta</th>
                                <th style="padding:8px; text-align:left; border:1px solid #ddd; width:28%;">Nombre de Cuenta</th>
                                <th style="padding:8px; text-align:right; border:1px solid #ddd; width:15%;">Saldo del Mes Anterior</th>
                                <th style="padding:8px; text-align:right; border:1px solid #ddd; width:15%;">Saldo del Mes Actual</th>
                                <th style="padding:8px; text-align:right; border:1px solid #ddd; width:15%;">Saldo General del Mes</th>
                                <th style="padding:8px; text-align:right; border:1px solid #ddd; width:15%;">Saldo Neto</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="query" t-as="i">
                                <td style="padding:6px; border:1px solid #ddd;">
                                    <span t-esc="i['code']"/>
                                </td>
                                <td style="padding:6px; border:1px solid #ddd;">
                                    <span t-esc="i['ac_name']"/>
                                </td>
                                <td style="padding:6px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="i['beginning_balance_formatted']"/>
                                </td>
                                <td style="padding:6px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="i['ending_balance_formatted']"/>
                                </td>
                                <td style="padding:6px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="i['period_change_formatted']"/>
                                </td>
                                <td style="padding:6px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="i['net_balance_formatted']"/>
                                </td>
                            </tr>
                            <tr style="background-color:#e8e8e8; border-top:2px solid #000; font-weight:bold;">
                                <td colspan="2" style="padding:8px; text-align:center; border:1px solid #ddd;">
                                    <b>TOTAL</b>
                                </td>
                                <td style="padding:8px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="total_beginning_balance_formatted"/>
                                </td>
                                <td style="padding:8px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="total_ending_balance_formatted"/>
                                </td>
                                <td style="padding:8px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="total_period_change_formatted"/>
                                </td>
                                <td style="padding:8px; border:1px solid #ddd; text-align:right;">
                                    <span t-esc="currency"/>
                                    <span t-esc="total_net_balance_formatted"/>
                                </td>
                            </tr>
                            <!-- Validation Row -->
                            <tr style="background-color:#f9f9f9; border-top:1px solid #ccc;">
                                <td colspan="2" style="padding:6px; text-align:center; border:1px solid #ddd; font-style:italic;">
                                    <t t-if="is_balanced">
                                        <span style="color:green;">✓ Balance Equilibrado</span>
                                    </t>
                                    <t t-else="">
                                        <span style="color:red;">✗ Balance Desequilibrado</span>
                                    </t>
                                </td>
                                <td colspan="2" style="padding:6px; border:1px solid #ddd; text-align:center; font-size:10px;">
                                    <strong>Total Débitos:</strong><br/>
                                    <span t-esc="currency"/><span t-esc="total_debits_formatted"/>
                                </td>
                                <td colspan="2" style="padding:6px; border:1px solid #ddd; text-align:center; font-size:10px;">
                                    <strong>Total Créditos:</strong><br/>
                                    <span t-esc="currency"/><span t-esc="total_credits_formatted"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </t>
                
                <!-- Footer Section -->
                <div style="margin-top:30px; padding-top:15px; border-top:1px solid #ccc; font-size:10px;">
                    <table style="width:100%;">
                        <tr>
                            <td style="width:50%;">
                                <strong>Preparado por:</strong> <t t-esc="prepared_by"/><br/>
                                <strong>Fecha de preparación:</strong> <t t-esc="prepared_date"/>
                            </td>
                            <td style="width:50%; text-align:right; font-size:9px; color:#666;">
                                Preparado conforme a las Normas Internacionales de Información Financiera (NIIF)
                            </td>
                        </tr>
                    </table>
                </div>
            </t>
        </t>
    </template>
</odoo>